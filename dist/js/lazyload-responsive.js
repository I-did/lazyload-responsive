(function(a){"function"==typeof define&&define.amd?define([],a):"object"==typeof exports?module.exports=a():window.lazyload=a()})(function(){let a,b={},c=0;return class{constructor(c,d){for(let e in a=this,a.defaults={mode:"observe",selector:".lazy",srcAttr:"data-src",mediaAttr:"data-media"},c&&("string"==typeof c?(b=a.options=d,b.selector=c):b=a.options=c),a.defaults)void 0===b[e]&&(b[e]=a.defaults[e]);a.init()}init(){let c=[...document.querySelectorAll(b.selector)];a.elements=c.map((c,d)=>({id:d,tag:c,dataSrc:c.getAttribute(b.srcAttr)||c.getAttribute("data-poster"),media:c.hasAttribute(b.mediaAttr)&&c.getAttribute(b.mediaAttr).replace(/\n*\t*/g,""),load(c){let e=this.checkMedia(this.firstMedia,this.otherMedia),f=this.media&&e?this.mediaQuiries[e]:this.dataSrc,g=this.tag;if(a.arrayEquality(f,this.currentUrl)||g.innerHTML===this.dataSrc+"")return void a.loadNextElem();if(this.currentUrl=[],this.content)g.innerHTML+=this.dataSrc,a.loadNextElem();else if("IMG"===g.tagName||"IFRAME"===g.tagName)g.src=f,this.currentUrl.push(f[d]),"progressive"===b.mode?g.addEventListener("load",function(){a.loadNextElem()},{once:!0}):"embed"===b.mode&&(console.log("msg"),a.loadNextElem());else if("VIDEO"===g.tagName){g.setAttribute("poster",this.dataSrc);for(let a of g.children)("SOURCE"===a.tagName||"TRACK"===a.tagName)&&a.setAttribute("src",a.getAttribute("data-src"));g.load()}else if("observe"!==b.mode&&g.addEventListener("loaded",function(){a.loadNextElem()},{once:!0}),g.style.backgroundImage="","progressive"===b.mode)this.progressiveLoadBackgrounds(f);else{for(let a=0;a<f.length;a++)-1===f[a].search(/gradient\(.*?\)|url\(.*?\)/)&&(f[a]=f[a].replace(/.*/,"url($&)")),this.currentUrl.push(f[a]);g.style.backgroundImage=f+"",g.dispatchEvent(new Event("loaded"))}},progressiveLoadBackgrounds(a,b){let c=++b||0;if(a[c]){let b,d=document.createElement("img");this.currentUrl.push(a[c]),b=-1===a[c].search(/gradient\(.*?\)|url\(.*?\)/)?a[c].replace(/.*/,"url($&)"):a[c],this.tag.style.backgroundImage+=0===c?b:`,${b}`,-1===a[c].search(/gradient\(.*?\)/)?(d.setAttribute("src",a[c].replace(/url\((.*)\)/,"$1")),d.addEventListener("load",()=>this.progressiveLoadBackgrounds(a,c),{once:!0})):this.progressiveLoadBackgrounds(a,c)}else this.tag.dispatchEvent(new Event("loaded"))},checkMedia:function(a,b){if(this.media)return new Function("firstMedia","otherMedia",`
							if (window.matchMedia('${a}').matches) {
								return '${a}';
							} ${function(){if(0===b.length)return"";let a="";for(let c=0;c<b.length;c++)a+=`else if (window.matchMedia('${b[c]}').matches) {return '${b[c]}'}`;return a+=`else {
									return false;
								}`,a}()}
					 `)()}})),a.prepareElements()}prepareElements(){window.addEventListener("load",function(){let d=/(?:\,\s?)(?=url|linear|radial|conic|repeating|(?:\.(?!\d))|\/)/;a.elements.forEach(function(b){if(b.content=-1!==b.dataSrc.search(/<.*?>/),b.dataSrc=b.dataSrc.replace(/\n*\t*/g,"").split(d),b.media){b.mediaQuiries={},b.mediaArray=[];let c,e,f,g=b.media.split(";");for(let a of g)a=a.replace(/(.*?){/,function(a,b){return c=b,""}).replace(/}$/,"").split(d),b.mediaQuiries[c]=a,b.mediaArray.push(c);a.minmax(b,e,"min"),a.minmax(b,f,"max"),b.mediaArray.every(a=>a.includes("max-width"))?(b.mediaArray.reverse(),b.firstMedia=b.minMedia):b.mediaArray.every(a=>a.includes("min-width"))?(b.firstMedia=b.maxMedia,b.mediaArray.reverse()):b.firstMedia=b.mediaArray[0],b.otherMedia=b.mediaArray.filter(a=>b.firstMedia!==a)}}),"observe"===b.mode?a.observer():a.loadNext(),setTimeout(()=>{window.addEventListener("resize",()=>{c=0,a.loadNext()})},10)},{once:!0})}observer(){function b(){c.top=pageYOffset,c.bottom=pageYOffset+window.screen.height;for(let b of a.elements)b.observed&&b.posBottom>c.top&&b.posTop<c.bottom&&(b.load(!0),b.observed=!1)}let c={top:pageYOffset,bottom:pageYOffset+window.screen.height};for(let b of a.elements)b.posTop=b.tag.getBoundingClientRect().top+pageYOffset,b.posBottom=b.tag.getBoundingClientRect().bottom+pageYOffset,b.observed=!0;b(),window.addEventListener("scroll",b)}arrayEquality(a,b){if(!b)return!1;if(a.length!==b.length)return!1;for(let c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}minmax(b,c,d){c=Math[d].apply(Math,b.mediaArray.map(b=>a.getMediaNumber(b))),b[`${d}Media`]=b.mediaArray.find(a=>-1!==a.search(c))}getMediaNumber(a){return+a.replace(/[^0-9|\.]/g,"")}loadNextElem(){c++,a.loadNext()}loadNext(){a.elements[c]&&a.elements[c].load()}}});